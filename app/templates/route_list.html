{% extends "base.html" %}

{% block content %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>–ú–æ–∏ –º–∞—Ä—à—Ä—É—Ç—ã</h2>
        {# 1. –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞: –ò–∑–º–µ–Ω–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ #}
        <a href="{{ url_for('create_or_edit_route_info') }}" class="btn btn-success">
            <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –º–∞—Ä—à—Ä—É—Ç
        </a>
    </div>

    {% if not routes %}
        <div class="alert alert-info" role="alert">
            –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤. –ù–∞—á–Ω–∏—Ç–µ —Å —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ!
        </div>
    {% else %}
        <div class="table-responsive">
            <table class="table table-striped table-hover align-middle">
                <thead>
                    <tr>
                        <th scope="col">‚Ññ</th>
                        <th scope="col">–ù–∞–∑–≤–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞</th>
                        <th scope="col">–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫ (ID)</th>
                        <th scope="col">–¢–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞</th>
                        <th scope="col">–û—Å—Ç–∞–Ω–æ–≤–∫–∏</th>
                        <th scope="col">–¢–∞—Ä–∏—Ñ—ã</th>
                        <th scope="col" class="text-center" style="min-width: 250px;">–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% for route in routes %}
                        <tr>
                            <th scope="row">{{ loop.index }}</th>
                            <td>
                                <strong>{{ route.route_name }}</strong>
                            </td>
                            <td>{{ route.carrier_id }}</td>
                            <td>
                                {# –í—ã–≤–æ–¥–∏–º –ø–æ–Ω—è—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ #}
                                {% if route.transport_type == '0x02' %}–ê–≤—Ç–æ–±—É—Å (–≥–æ—Ä–æ–¥—Å–∫–æ–π)
                                {% elif route.transport_type == '0x20' %}–ê–≤—Ç–æ–±—É—Å (–ø—Ä–∏–≥–æ—Ä–æ–¥–Ω—ã–π)
                                {% else %}–ö–æ–¥: {{ route.transport_type }}{% endif %}
                            </td>
                            <td>
                                {{ route.stops | length if route.stops else 0 }}
                            </td>
                            <td>
                                {{ route.tariffs | length if route.tariffs else 0 }}
                            </td>
                            <td class="d-flex justify-content-center align-items-center"> 
                                {# 2. –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–®–∞–≥ 1) #}
                                <a href="{{ url_for('create_or_edit_route_info', route_id=route.id) }}" 
                                   class="btn btn-sm btn-outline-info me-2" 
                                   data-bs-toggle="tooltip" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é">
                                    <i class="fas fa-edit"></i> Info
                                </a>
                                
                                {# –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ (–®–∞–≥ 2) #}
                                <a href="{{ url_for('edit_route_stops', route_id=route.id) }}" 
                                   class="btn btn-sm btn-outline-info me-2" 
                                   data-bs-toggle="tooltip" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫–∏">
                                    <i class="fas fa-map-marker-alt"></i> –û—Å—Ç–∞–Ω–æ–≤–∫–∏
                                </a>
                                
                                {# –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–Ω (–®–∞–≥ 3) #}
                                <a href="{{ url_for('edit_route_prices', route_id=route.id) }}" 
                                   class="btn btn-sm btn-outline-info me-2"
                                   data-bs-toggle="tooltip" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ç—Ä–∏—Ü—É —Ü–µ–Ω">
                                    <i class="fas fa-dollar-sign"></i> –¶–µ–Ω—ã
                                </a>

                                {# –ö–Ω–æ–ø–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∞–π–ª–∞ #}
                                <a href="{{ url_for('generate_config', route_id=route.id) }}" 
                                    class="btn btn-sm btn-primary me-2"
                                    data-bs-toggle="tooltip" title="–°–∫–∞—á–∞—Ç—å TRFZ —Ñ–∞–π–ª">
                                    <i class="fas fa-download"></i> –ö–æ–Ω—Ñ–∏–≥
                                </a>
                                
                                {# üí• –ù–û–í–ê–Ø –ö–ù–û–ü–ö–ê: –§–û–†–ú–ê –î–õ–Ø –£–î–ê–õ–ï–ù–ò–Ø –ú–ê–†–®–†–£–¢–ê #}
                                <form method="POST" action="{{ url_for('delete_route', route_id=route.id) }}" class="m-0 p-0">
                                    {# üí• –ò–°–ü–û–õ–¨–ó–£–ï–ú –ü–ï–†–ï–ú–ï–ù–ù–£–Æ, –ü–ï–†–ï–î–ê–ù–ù–£–Æ –ò–ó PYTHON #}
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                    
                                    <button type="submit" 
                                            class="btn btn-sm btn-danger" 
                                            data-bs-toggle="tooltip" title="–£–¥–∞–ª–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç"
                                            onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç {{ route.route_name }}? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.');">
                                        <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                                    </button>
                                </form>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% endif %}

    {# –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∏–∫–æ–Ω–æ–∫ FontAwesome –∏ Bootstrap tooltips #}
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–ø–ª—ã–≤–∞—é—â–∏—Ö –ø–æ–¥—Å–∫–∞–∑–æ–∫ Bootstrap
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
          return new bootstrap.Tooltip(tooltipTriggerEl)
        })
    </script>
{% endblock %}
